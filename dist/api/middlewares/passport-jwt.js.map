{"version":3,"sources":["../../../src/api/middlewares/passport-jwt.js"],"names":["configureJWTStrategy","opts","jwtFromRequest","PassportJWT","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","devConfig","secret","passport","use","Strategy","payload","done","User","findOne","_id","id","err","user"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAGO,IAAMA,sDAAuB,SAAvBA,oBAAuB,GAAM;AACxC,MAAMC,OAAO,EAAb;AACAA,OAAKC,cAAL,GAAsBC,sBAAYC,UAAZ,CAAuBC,2BAAvB,EAAtB;AACAJ,OAAKK,WAAL,GAAmBC,sBAAUC,MAA7B;AACAC,qBAASC,GAAT,CACE,IAAIP,sBAAYQ,QAAhB,CAAyBV,IAAzB,EAA+B,UAACW,OAAD,EAAUC,IAAV,EAAmB;AAChDC,mBAAKC,OAAL,CAAa,EAAEC,KAAKJ,QAAQK,EAAf,EAAb,EAAkC,UAACC,GAAD,EAAMC,IAAN,EAAe;AAC/C,UAAID,GAAJ,EAAS;AACP,eAAOL,KAAKK,GAAL,EAAU,KAAV,CAAP;AACD;AACD,UAAIC,IAAJ,EAAU;AACR,eAAON,KAAK,IAAL,EAAWM,IAAX,CAAP;AACD;AACD,aAAON,KAAK,IAAL,EAAW,KAAX,CAAP;AACA;AACD,KATD;AAUD,GAXD,CADF;AAcD,CAlBM","file":"passport-jwt.js","sourcesContent":["import PassportJWT from 'passport-jwt';\r\nimport passport from 'passport';\r\nimport devConfig from '../../config/env/development';\r\nimport User from '../model/user.model';\r\n\r\n\r\nexport const configureJWTStrategy = () => {\r\n  const opts = {};\r\n  opts.jwtFromRequest = PassportJWT.ExtractJwt.fromAuthHeaderAsBearerToken();\r\n  opts.secretOrKey = devConfig.secret;\r\n  passport.use(\r\n    new PassportJWT.Strategy(opts, (payload, done) => {\r\n      User.findOne({ _id: payload.id }, (err, user) => {\r\n        if (err) {\r\n          return done(err, false);\r\n        }\r\n        if (user) {\r\n          return done(null, user);\r\n        }\r\n        return done(null, false);\r\n        // or you could create a new account\r\n      });\r\n    })\r\n  );\r\n};"]}